# Copyright 2017 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/package.gni")

executable("bin") {
  output_name = "bluetooth"

  sources = [
    "bluetooth_manager.cc",
    "bluetooth_manager.h",
    "control_server.cc",
    "control_server.h",
    "app.cc",
    "app.h",
    "main.cc",
  ]

  deps = [
    "//garnet/public/lib/app/cpp",
    "//garnet/public/lib/bluetooth/fidl",
    "//garnet/public/lib/fsl",
    "//zircon/public/lib/async-loop-cpp",

    # Internal Bluetooth API
    "//garnet/lib/bluetooth/c",
    "//garnet/lib/bluetooth/fidl",
  ]
}

package("bluetooth") {
  deps = [
    ":bin",
  ]

  binary = "bluetooth"

  meta = [ {
        path = rebase_path("meta/sandbox")
        dest = "sandbox"
      } ]
}

executable("bluetooth_unittests") {
  testonly = true

  deps = [
    "//garnet/drivers/bluetooth/lib:tests",
    "//garnet/public/lib/fxl/test:gtest_main",
    "//third_party/googletest:gtest",
  ]
}

package("bluetooth_tests") {
  testonly = true
  deprecated_system_image = true

  package_name = "bluetooth_tests"

  deps = [
    ":bluetooth_unittests",
    "//garnet/bin/bluetooth_tests/integration:bluetooth",
  ]

  tests = [
    { name = "bluetooth_unittests" },
  ]
}
