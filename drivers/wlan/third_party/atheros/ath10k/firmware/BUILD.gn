#
# Copyright (c) 2018 The Fuchsia Authors.
#
# Permission to use, copy, modify, and/or distribute this software for any
# purpose with or without fee is hereby granted, provided that the above
# copyright notice and this permission notice appear in all copies.
#
# THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
# WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
# MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
# ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
# WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
# ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
# OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

import("//build/config/fuchsia/rules.gni")
import("//build/package.gni")

# Firmware files from git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git
copy("ath10k-firmware-copy") {
  sources = [
    "QCA4019/hw1.0/board-2.bin",
    "QCA4019/hw1.0/firmware-5.bin",
    "QCA6174/hw2.1/board-2.bin",
    "QCA6174/hw2.1/board.bin",
    "QCA6174/hw2.1/firmware-5.bin",
    "QCA6174/hw3.0/board-2.bin",
    "QCA6174/hw3.0/board.bin",
    "QCA6174/hw3.0/firmware-4.bin",
    "QCA6174/hw3.0/firmware-6.bin",
    "QCA9377/hw1.0/board-2.bin",
    "QCA9377/hw1.0/board.bin",
    "QCA9377/hw1.0/firmware-5.bin",
    "QCA9887/hw1.0/board.bin",
    "QCA9887/hw1.0/firmware-5.bin",
    "QCA9888/hw2.0/board-2.bin",
    "QCA9888/hw2.0/firmware-5.bin",
    "QCA988X/hw2.0/board.bin",
    "QCA988X/hw2.0/firmware-4.bin",
    "QCA988X/hw2.0/firmware-5.bin",
    "QCA9984/hw1.0/board-2.bin",
    "QCA9984/hw1.0/firmware-5.bin",
    "QCA99X0/hw2.0/board.bin",
    "QCA99X0/hw2.0/firmware-5.bin",
  ]
  outputs = [
    "$root_out_dir/firmware/ath10k/{{source_target_relative}}"
  ]
}

package("atheros-firmware") {
  system_image = true

  deps = [
    # The copy step has to be in the shared-library toolchain to use the
    # expected output directory, since we treat firmware blobs as if they
    # were libraries which always use the shared-library toolchain to build.
    ":ath10k-firmware-copy($shlib_toolchain)",
  ]

  libraries = [
       { name = "firmware/ath10k/QCA4019/hw1.0/board-2.bin" },
       { name = "firmware/ath10k/QCA4019/hw1.0/firmware-5.bin"},
       { name = "firmware/ath10k/QCA6174/hw2.1/board-2.bin"},
       { name = "firmware/ath10k/QCA6174/hw2.1/board.bin"},
       { name = "firmware/ath10k/QCA6174/hw2.1/firmware-5.bin"},
       { name = "firmware/ath10k/QCA6174/hw3.0/board-2.bin"},
       { name = "firmware/ath10k/QCA6174/hw3.0/board.bin"},
       { name = "firmware/ath10k/QCA6174/hw3.0/firmware-4.bin"},
       { name = "firmware/ath10k/QCA6174/hw3.0/firmware-6.bin"},
       { name = "firmware/ath10k/QCA9377/hw1.0/board-2.bin"},
       { name = "firmware/ath10k/QCA9377/hw1.0/board.bin"},
       { name = "firmware/ath10k/QCA9377/hw1.0/firmware-5.bin"},
       { name = "firmware/ath10k/QCA9887/hw1.0/board.bin"},
       { name = "firmware/ath10k/QCA9887/hw1.0/firmware-5.bin"},
       { name = "firmware/ath10k/QCA9888/hw2.0/board-2.bin"},
       { name = "firmware/ath10k/QCA9888/hw2.0/firmware-5.bin"},
       { name = "firmware/ath10k/QCA988X/hw2.0/board.bin"},
       { name = "firmware/ath10k/QCA988X/hw2.0/firmware-4.bin"},
       { name = "firmware/ath10k/QCA988X/hw2.0/firmware-5.bin"},
       { name = "firmware/ath10k/QCA9984/hw1.0/board-2.bin"},
       { name = "firmware/ath10k/QCA9984/hw1.0/firmware-5.bin"},
       { name = "firmware/ath10k/QCA99X0/hw2.0/board.bin"},
       { name = "firmware/ath10k/QCA99X0/hw2.0/firmware-5.bin"},
  ]
}
